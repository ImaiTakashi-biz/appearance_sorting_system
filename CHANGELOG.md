# CHANGELOG

## v1.1.7 (2026-01-07)
- 改善: 偏り是正フェーズでの10%超過解消処理を追加（`inspector_assignment_service.py`）
  - 偏り是正パス終了時に10%超過を検出した検査員から、他の検査員へ再割当を行う処理を追加
  - 当日洗浄上がり品の制約（品番単位・品名単位）を正しく更新する処理を追加
  - `filter_available_inspectors`の呼び出しを修正し、`get_available_inspectors`を使用するように変更
  - 10%超過を検出した検査員のロットを順次再割当し、超過分を解消する処理を実装
  - 偏り是正の段階で既に存在していた10%超過を解消可能に
  - 当日洗浄上がり品の制約違反を防止
  - 検査時間の偏り改善と10%超過の両立を実現

## v1.1.6 (2026-01-07)
- 修正: 洗浄二次処理依頼スプレッドシート「依頼一覧」シートの「詳細・備考」から日付を解析する際、12月の日付が現在の月より前の場合は前年として解釈するように修正（`cleaning_request_service.py`）
- 修正: 上記修正により、3D025-G4960が正しく抽出されるようになった

## v1.1.5 (2026-01-06)
- 改善: 最終検証フェーズで3営業日以内のロットは新製品チームも候補に追加し、未割当を減らす処理を強化（`inspector_assignment_service.py`）
- 改善: 上記判定と新製品チーム取得のデバッグログを追加し、調査しやすく調整
- 変更: バージョン情報を更新（`version.py`）

## v1.1.4 (2026-01-05)
- 追加: `cleaning_request_service.py` と `ui_handlers.py` に洗浄指示の行番号を追加し、重複判定に行番号を考慮するよう更新

## v1.1.3 (2025-12-25)
- 修正: Access VBA 実行時に「既にこのデータベースは開いています」で失敗するケースを回避（`DispatchEx`優先＋再Open）

## v1.1.2 (2025-12-25)
- 改善: 進捗バー表示の体感を最適化（Access VBA中のpulse停止対策、配分/速度調整）
- 変更: 要日出荷（当日/過去）のロットは最終検証で未割当に落とさず割当維持を優先

## v1.1.1 (2025-12-25)
- 追加: バージョン情報の一元管理（`version.py`）、タイトルバー表示、ヘルプ→バージョン情報（About）
- 更新: README/ヘルプの記載を現行仕様に同期（座席表はローカルHTTPサーバ経由で共有JSONへ保存）

## v1.1.0 (2025-12-24)
- 追加: Access VBA 連携による不足集計更新（抽出開始時に `ShukkahusokuCalculate` 実行）
- 修正: Access VBA 呼び出しを管理者手順に合わせて安定化（`Dispatch`/`run`、日付 `yyyy/mm/dd`）
- 改善: 進捗バー表示を調整（パルス表示・表示配分の調整）
- 変更: 座席表UIレイアウト調整
- 改善: ログ出力のバッファリング、休暇/洗浄のキャッシュ、割当最適化の内部改善
