# å‡ºè·æ¤œæŸ»ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã‚·ã‚¹ãƒ†ãƒ 

Accessãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å‡ºè·æ¤œæŸ»æ®‹ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹ç¾ã—ã„UIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## æ©Ÿèƒ½

### ğŸ¨ ç¾ã—ã„UIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- **è¿‘æœªæ¥çš„ãªãƒ‡ã‚¶ã‚¤ãƒ³**: ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒã¨ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯é¢¨ã®ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
- **å‡ºè·äºˆå®šæ—¥æŒ‡å®š**: é–‹å§‹æ—¥ã¨çµ‚äº†æ—¥ã‚’æŒ‡å®šã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—è¡¨ç¤º**: ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
- **å‡ºåŠ›å½¢å¼é¸æŠ**: CSVã€Excelã€ã¾ãŸã¯ä¸¡æ–¹ã§ã®å‡ºåŠ›
- **å‡ºåŠ›å…ˆãƒ•ã‚©ãƒ«ãƒ€é¸æŠ**: ä»»æ„ã®ãƒ•ã‚©ãƒ«ãƒ€ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°**: å®Ÿè¡ŒçŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèª
- **è¨­å®šãƒªãƒ­ãƒ¼ãƒ‰**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å†èª­ã¿è¾¼ã¿æ©Ÿèƒ½

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
appearance_sorting_system/
â”œâ”€â”€ main.py                       # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ config.py                     # è¨­å®šç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”œâ”€â”€ config.env                    # ç’°å¢ƒå¤‰æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ requirements.txt              # å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”œâ”€â”€ build_exe.py                  # exeåŒ–ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ build.bat                     # exeåŒ–ç”¨ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ README.md                     # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ä»®æƒ³ç’°å¢ƒã®æ§‹ç¯‰

```bash
# ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆ
python -m venv .venv

# ä»®æƒ³ç’°å¢ƒã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆï¼ˆWindowsï¼‰
.venv\Scripts\activate

# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`config.env`ãƒ•ã‚¡ã‚¤ãƒ«ã§ä»¥ä¸‹ã®è¨­å®šã‚’è¡Œã£ã¦ãã ã•ã„ï¼š

```env
# Accessãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š
ACCESS_FILE_PATH=C:\Users\SEIZOU-20\Desktop\æŒ¯åˆ†ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±\å‡ºè·æ¤œæŸ»ä¸€è¦§(å‡ºè·ä¸è¶³ã®ã¿).accdb
ACCESS_TABLE_NAME=T_å‡ºè·æ¤œæŸ»æ®‹

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šè¨­å®š
DB_DRIVER=Microsoft Access Driver (*.mdb, *.accdb)
```

### 3. Access Driverã®ç¢ºèª

Windowsç’°å¢ƒã§Accessãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹ã«ã¯ã€Microsoft Access Database EngineãŒå¿…è¦ã§ã™ã€‚

- **32bitç‰ˆ**: Microsoft Access Database Engine 2016 Redistributable (32bit)
- **64bitç‰ˆ**: Microsoft Access Database Engine 2016 Redistributable (64bit)

## ä½¿ç”¨æ–¹æ³•

### é–‹ç™ºç’°å¢ƒã§ã®å®Ÿè¡Œ

```bash
# ä»®æƒ³ç’°å¢ƒã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
.venv\Scripts\activate

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
python main.py
```

### ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆexeï¼‰ã¨ã—ã¦å®Ÿè¡Œ

#### 1. exeãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

```bash
# ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
build.bat

# ã¾ãŸã¯æ‰‹å‹•ã§å®Ÿè¡Œ
.venv\Scripts\activate
python build_exe.py
```

#### 2. exeãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œ

1. `dist`ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ã€Œå‡ºè·æ¤œæŸ»ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã‚·ã‚¹ãƒ†ãƒ .exeã€ã‚’å®Ÿè¡Œ
2. åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã€Œconfig.envã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®
3. config.envãƒ•ã‚¡ã‚¤ãƒ«ã§Accessãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’è¨­å®š

## å®Ÿè¡Œçµæœ

æŒ‡å®šã—ãŸå‡ºåŠ›ãƒ•ã‚©ãƒ«ãƒ€ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼š
- `å‡ºè·æ¤œæŸ»æ®‹_YYYY-MM-DD_YYYY-MM-DD_YYYYMMDD_HHMMSS.csv` - CSVå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿
- `å‡ºè·æ¤œæŸ»æ®‹_YYYY-MM-DD_YYYY-MM-DD_YYYYMMDD_HHMMSS.xlsx` - Excelå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿

## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒªã®å®Ÿè¡Œ

`main.py`ã®`extract_data_thread`ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒªã‚’æŒ‡å®šã§ãã¾ã™ï¼š

```python
# ä¾‹ï¼šç‰¹å®šã®æ¡ä»¶ã§ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
query = f"""
SELECT * FROM [{self.config.access_table_name}] 
WHERE å‡ºè·äºˆå®šæ—¥ >= #{start_date}# 
AND å‡ºè·äºˆå®šæ—¥ <= #{end_date}#
AND ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ = 'æœªå‡¦ç†'
ORDER BY å‡ºè·äºˆå®šæ—¥
"""
```

### å‡ºåŠ›å½¢å¼ã®å¤‰æ›´

CSVãƒ»Excelä»¥å¤–ã®å½¢å¼ã§å‡ºåŠ›ã—ãŸã„å ´åˆã¯ã€`extract_data_thread`ãƒ¡ã‚½ãƒƒãƒ‰ã«æ–°ã—ã„ä¿å­˜å‡¦ç†ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

## exeåŒ–ã«ã¤ã„ã¦

### ãƒ“ãƒ«ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³

- **--onefile**: å˜ä¸€ã®exeãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›
- **--windowed**: ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’éè¡¨ç¤º
- **--add-data**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ã‚‹
- **--hidden-import**: å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ˜ç¤ºçš„ã«æŒ‡å®š

### é…å¸ƒæ™‚ã®æ³¨æ„ç‚¹

1. **config.envãƒ•ã‚¡ã‚¤ãƒ«**: exeãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®
2. **Access Driver**: å®Ÿè¡Œç’°å¢ƒã«Microsoft Access Database Engineã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
3. **ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º**: ç´„50-100MBç¨‹åº¦ã®exeãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼

1. **"Microsoft Access Driver not found"**
   - Microsoft Access Database Engineã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„

2. **"Accessãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"**
   - `config.env`ã®`ACCESS_FILE_PATH`ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„

3. **"ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"**
   - `config.env`ã®`ACCESS_TABLE_NAME`ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„

4. **exeãƒ•ã‚¡ã‚¤ãƒ«ãŒèµ·å‹•ã—ãªã„**
   - ã‚¦ã‚¤ãƒ«ã‚¹å¯¾ç­–ã‚½ãƒ•ãƒˆãŒãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ã„ãªã„ã‹ç¢ºèª
   - Windows Defenderã®é™¤å¤–è¨­å®šã‚’è¿½åŠ 

### ãƒ­ã‚°ã®ç¢ºèª

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®ãƒ­ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å®Ÿè¡ŒçŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã™ã€‚

## æŠ€è¡“ä»•æ§˜

- **UI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: CustomTkinter 5.2.2
- **ãƒ‡ãƒ¼ã‚¿å‡¦ç†**: pandas 2.1.4
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: pyodbc 5.0.1
- **exeåŒ–**: PyInstaller 6.3.0
- **Python**: 3.8ä»¥ä¸Š

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚